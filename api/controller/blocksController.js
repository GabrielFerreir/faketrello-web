let db = require('../db-config.js')

//Adiciona quadros nos projetos
exports.newblock = function (req, res) {
  let idProject = req.params.id
  db.any('SELECT * FROM newblocks($1,$2)', [req.body.nameblock, idProject])
    .then(data => {
      if (data) {
        res.status(200).json({result: 'Quadro criado'})
      } else {
        res.status(404).json({error: 'Projeto nao foi encontrado'})
      }
    })
}
//Mostra os blocos do projeto
exports.seachblock = function (req, res) {
  db.any('SELECT * FROM searchBlock($1)', [req.body.newname])
    .then(data => {
      if (!data || !data[0]) {
        res.status(404).json({error: 'Esse projeto nao foi encontrado'})
      } else {
        res.status(200).json({data})
      }
    })
}

exports.deleteBlock = function (req, res) {
  db.any('SELECT * FROM deleteBlock($1)', [req.body.nameBlock])
    .then(data => {
      if (data) {
        res.status(200).json({result: 'Bloco deletado!'})
      } else {
        res.status(404).json({error: 'Bloco nao encontrado'})
      }
    })
}
