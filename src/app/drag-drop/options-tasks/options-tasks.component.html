<section class="container">
  <nav class="tab">
    <ul>
      <li (click)="navbasicos()">Basicas</li>
      <li (click)="navComentarios()">Comentarios</li>
      <li (click)="navChecklist()">Checklist</li>
      <li (click)="navMembros()">Time</li>
      <li (click)="navAnexos()">Anexos</li>
    </ul>
  </nav>
  <section class="conteudo">
    <div class="conteudoNav" #conteudoNav>
      <div class="basicas">
        <div style="position: relative">
          <input type="text" class="textFields" #HTMLNameTask [(ngModel)]="nome"
                 (blur)="verificaInputs(); alteraDadosBasicos();">
          <div class="labelText">Nome</div>
          <div class="border"></div>
        </div>

        <div style="position: relative; margin-top: 50px;">
          <input type="text" class="textFields" #HTMLFinalDate [(ngModel)]="data" (keyup)='formatarData()'
                 (blur)="verificaInputs(); alteraDadosBasicos();">
          <div class="labelText">Data</div>
          <div class="border"></div>
        </div>
        <div style="position: relative; margin-top: 100px">
          <textarea class="textFieldsMult" #HTMLDescription style="min-height: 120px" (blur)="alteraDadosBasicos()">{{ descricao }}</textarea>
          <!--<div class="labelTextMult">Descrição</div>-->
          <div class="border"></div>
        </div>
      </div>
      <div class="comentarios">
        <div style="position: relative; margin-top: 10px; width: 90%; margin-left: 5%; float: left">
          <input type="text" class="textFields" id="addComentario" #HTMLInputComment
                 [(ngModel)]="dragDropService.addComment" (keyup.enter)="dragDropService.newCommentTask()"
                 (blur)="inputComment()">
          <label class="labelText" for="addComentario">Adicionar Comentario</label>
          <div class="border"></div>
        </div>
        <div class="scrollComentarios">
          <ul>
            <li *ngFor="let comentario of dragDropService?.infoOptionTask?.comments">
              <span *ngIf="!modifyComment || idModifyComment != comentario.id_comment">{{ comentario.comment }}</span>
              <input *ngIf="modifyComment && idModifyComment == comentario.id_comment" class="textFields modifyComments"
                     style="width: calc(100% - 100px);" (blur)="dragDropService.changeCommentTask(comentario.comment)" [(ngModel)]="comentario.comment">
              <div class="more" (click)="onMoreOptionsComments(comentario.id_comment)"></div>
              <div [hidden]="!moreOptionsComments || comentario.id_comment != idMoreOptionsComments"
                   class="optionsMore">
                <ul>
                  <li (click)="onModifyComment(comentario.id_comment)">Alterar Comentario</li>
                  <li (click)="dragDropService.delCommentTask(comentario.id_comment)">Excluir Comentario</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <div class="checklist">
        <div style="position: relative; margin-top: 10px; width: 90%; margin-left: 5%; float: left">
          <input type="text" class="textFields" #HTMLInputChecklist (blur)="inputChecklist()"
                 [(ngModel)]="dragDropService.addNewChecklist"
                 (keyup.enter)="dragDropService.newChecklist(dragDropService.addNewChecklist)">
          <label class="labelText">Adicionar Checklist</label>
          <div class="border"></div>
        </div>
        <div class="scrollChecklist">
          <ul>
            <li *ngFor="let checklist of dragDropService?.infoOptionTask?.checklists">
              <input type="checkbox" id="{{ 'check' + checklist.id_checklist }}" [checked]="checklist.checked">
              <label [for]="'check' + checklist.id_checklist"
                     (click)="dragDropService.changeSituationCheckbox(checklist.id_checklist)">
                <div class="img"></div>
              </label>
              <span *ngIf="!modifyChecklist || idModifyChecklist != checklist.id_checklist">{{ checklist.name_checklist }}</span>
              <input *ngIf="modifyChecklist && idModifyChecklist == checklist.id_checklist" class="textFields modifyChecklist"
                     style="width: calc(100% - 100px);" (blur)="dragDropService.changeChecklistTask(checklist.name_checklist)" [(ngModel)]="checklist.name_checklist">

              <div class="more moreCheckbox" (click)="onMoreOptionsChecklist(checklist.id_checklist)"></div>
              <div [hidden]="!moreOptionsChecklist || checklist.id_checklist != idMoreOptionsChecklist"
                   class="optionsMore">
                <ul>
                  <li (click)="onModifyChecklist(checklist.id_checklist)">Alterar Checklist</li>
                  <li (click)="dragDropService.delChecklist(checklist.id_checklist)">Excluir Checklist</li>
                </ul>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <div class="membros">
            <section class="search">
              <input type="text" class="textFields" (focus)="showSearchMembros()" (blur)="hideSearchMembros()" [(ngModel)]="search">
              <label class="labelText">Nome</label>
              <div class="border"></div>
            </section>
            <section class="chipsFocus" *ngIf="searchMembros">
              <article class="chipFocus" *ngFor="let membro of projectService?.project?.team | pesquisaDeMembrosDoProjeto: search: dragDropService?.infoOptionTask?.team" (mousedown)="dragDropService.addMemberTask(membro.id_user)">
                <section class="img" *ngIf="membro.profile_img == '/imgsUser/default.png'">{{ membro.name.charAt(0) | uppercase }}</section>
                <section *ngIf="membro.profile_img != '/imgsUser/default.png'" [style.background-image]="'url('+ 'http://' + core.ipDaApi + membro.profile_img +')'" class="img"></section>
                <section class="hgroup">
                  <h1 class="name">{{ membro.name }}</h1>
                  <h2 class="email">{{ membro.email }}</h2>
                </section>

              </article>
            </section>
        <section class="chips">
          <article class="chip" *ngFor="let membro of dragDropService?.infoOptionTask?.team">
            <section class="img" *ngIf="membro.profile_img == '/imgsUser/default.png'">{{ membro.name.charAt(0) | uppercase }}</section>
            <section *ngIf="membro.profile_img != '/imgsUser/default.png'" [style.background-image]="'url('+ 'http://' + core.ipDaApi + membro.profile_img +')'" class="img"></section>
            <h1 class="name">{{ membro.name }}</h1>
            <section class="delete" (click)="dragDropService.delMemberTask(membro.id_team_task)"></section>
          </article>
        </section>

      </div>
      <div class="anexos">
        <div class="scrollAnexos">
          <ul>
            <li (click)="openFileAnexo()">Adicionar Anexo</li>
            <input type="file" id="addAnexo" (change)="getFile($event.target)">
            <li *ngFor="let anexo of dragDropService?.infoOptionTask?.attachment">
              <div class="icon"></div>
              <a [href]=" 'http://' + core.ipDaApi +  anexo.path" target="_blank"> {{ anexo.file_name + '.' +
                anexo.path.split(".")[1]}}</a>
            </li>

          </ul>

        </div>
      </div>
    </div>
    <button class="denseButton" style="position: absolute; right: 16px; bottom: 60px;"
            (click)="dragDropService.offOptionsTasks()"> FECHAR
    </button>
  </section>
</section>
